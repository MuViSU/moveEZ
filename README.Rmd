---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# moveEZ <img src="logo.png" align="right" width="150" alt="" />

<!-- badges: start -->
<!-- badges: end -->

The goal of moveEZ is to create animated biplots. 

## Installation

You can install the development version of moveEZ from [GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("MuViSU/moveEZ")
```

Consider a dataset ${\bf{X}}$ comprising $n$ observations and $p$ continuous variables, along with an additional variable representing "time." This time variable need not correspond to chronological time; it could just as well represent another form of ordered index, such as algorithmic iterations or experimental stages.

A natural approach is to construct separate biplots for each level of the time variable, enabling the user to explore how samples and variable relationships evolve across time. However, when the time variable includes many levels, this quickly results in an overwhelming number of biplots.

This package addresses that challenge by animating a single biplot across the levels of the time variable, allowing for dynamic visualisation of temporal or sequential changes in the data.

The animation of the biplots—currently limited to PCA biplots—is based on two conceptual frameworks:

1. Fixed Variable Frame `moveplot()`: A biplot is first constructed using the full dataset ${\bf{X}}$, and the animation is achieved by slicing the observations according to the "time" variable. In this approach, the variable axes remain fixed, and only the sample points are animated over time.


2. Dynamic Frame `moveplot2()`: Separate biplots are constructed for each time slice of the data. Both the sample points and variable axes evolve over time, resulting in a fully dynamic animation that reflects temporal changes in the underlying data structure.

To illustrate the animated biplots, we use a climate dataset included in the package. This dataset, Africa_climate, contains climate measurements from 10 African regions over time:

```{r}
library(moveEZ)
data("Africa_climate")
tibble::tibble(Africa_climate)
```

We begin by constructing a standard PCA biplot using the `biplotEZ` package. This biplot aggregates all samples across time and colours them according to their associated region:
```{r, message=FALSE}
library(biplotEZ)
bp <- biplot(Africa_climate, scaled = TRUE) |> 
  PCA(group.aes = Africa_climate$Region) |> 
  samples(opacity = 0.8, col = scales::hue_pal()(10)) |>
  plot()
```

# 1. Fixed Variable Frame with `moveplot()`
Using the previously created PCA biplot object `bp`, the `moveplot()` function enables animation of the sample points over time. This function is piped with several key arguments:

- `time.var`: Specifies the name of the variable in the dataset that represents the temporal or sequential dimension. In this case, the variable "Year" relates to the time variable.

- `group.var`: Indicates a grouping variable used for colour-coding. In this case, the variable "Region" relates to the group variable.

- `hulls`: A logical flag that determines whether to display individual sample points or to draw convex hulls around each group.

`move`: A critical argument that controls whether the biplot is animated. If set to `TRUE`, the sample points are animated across time. If set to `FALSE`, the function returns a faceted plot showing a static biplot for each time level.

This design provides flexibility in exploring temporal dynamics in multivariate data, with options for both animated and comparative static visualisations.


## Facet: `move = FALSE`
```{r,warning=FALSE}
bp |> moveplot(time.var = "Year", group.var = "Region", hulls = TRUE, move = FALSE)
```

## Animation: `move = TRUE`
```{r,warning=FALSE}
# Animated Z
bp |> moveplot(time.var = "Year", group.var = "Region", hulls = TRUE, move = TRUE)
```


# 2. Dynamic Frame `moveplot2()`
The `moveplot2()` function extends the animation to both the sample points and the variable axes. Unlike `moveplot()`, which keeps the variable axes fixed, `moveplot2()` constructs a separate biplot for each time slice, allowing both components to evolve over time. The function shares the same arguments as `moveplot()`, with the `move` argument determining whether the animation is shown or presented as static facets for samples and variables.

## Facet: `move = FALSE`
```{r,warning=FALSE}
bp |> moveplot2(time.var = "Year", group.var = "Region", hulls = TRUE, move = FALSE)
```
When `move` is FALSE, a faceted plot is returned, showing the biplot at each time point. Here, both the sample coordinates and variable axes differ across facets, reflecting temporal changes in the data structure.

## Facet: `move = TRUE`
```{r,warning=FALSE}
bp |> moveplot2(time.var = "Year", group.var = "Region", hulls = TRUE, move = TRUE)
```

Setting `move` to TRUE produces an animated biplot in which both the samples and variables transition across time, offering a dynamic view of structural shifts in the multivariate space. 


# Still to Come!
Watch this space! We are actively working on enhancing `moveplot2()` by aligning the biplots across time slices. This will allow for smoother transitions and more interpretable animations when both samples and variable axes evolve.

Stay tuned for updates!









